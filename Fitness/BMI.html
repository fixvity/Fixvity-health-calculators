<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ultimate BMI Calculator — Final Gauge</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#f4f8fb; --card:#ffffff; --accent:#0b7285; --muted:#6b7176;
  --border:rgba(18,24,30,0.08); --danger:#ef4444; --ok:#10b981; --warn:#f59e0b; --deep:#08323a;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial}
.container{max-width:980px;margin:18px auto;padding:14px}
.card{background:var(--card);border-radius:16px;padding:16px;box-shadow:0 18px 36px rgba(12,18,24,0.06)}
.header{display:flex;justify-content:space-between;align-items:flex-start;padding:6px 6px 14px}
.title{font-size:24px;margin:0;font-weight:800}
.brand{color:var(--muted);font-weight:600;font-size:13px}

/* layout */
.grid{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:980px){ .grid{grid-template-columns:1fr 420px} }

.inputs{padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid var(--border)}
.label{font-size:13px;color:#0b1720;margin-bottom:6px;display:block}
.input{width:100%;padding:12px;border-radius:10px;border:1px solid var(--border);font-size:15px;background:transparent}
.controls{display:flex;align-items:center;gap:10px;margin-top:12px;flex-wrap:wrap;justify-content:space-between}
.btnPrimary{background:var(--accent);color:white;border:0;padding:10px 14px;border-radius:10px;font-weight:800;cursor:pointer}
.btnGhost{background:#fff;border:1px solid var(--border);padding:9px 12px;border-radius:10px;cursor:pointer}

/* results card */
.results{padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid var(--border)}
.gaugeWrap{width:100%;display:flex;flex-direction:column;align-items:center}
.svgWrap{width:100%;padding:8px 28px 0;box-sizing:border-box} /* horizontal padding to allow tick labels room */
svg.gauge{width:100%;height:auto;display:block}

/* needle */
.needle{transform-origin:480px 360px;transition:transform 700ms cubic-bezier(.18,.8,.24,1);}

/* result top */
.resultTop{display:flex;gap:10px;align-items:flex-start;justify-content:flex-start;width:100%}
.bmiNumber{font-weight:700;font-size:40px;color:var(--deep);margin:0;line-height:1}
.unit{font-size:16px;color:var(--muted);margin-left:8px}
.category{font-size:22px;font-weight:800;margin-left:22px;color:var(--warn)}
/* slightly smaller on small screens to avoid collision */
@media(max-width:520px){
  .bmiNumber{font-size:34px}
  .category{font-size:20px}
}

/* legend + details */
.legend{display:flex;flex-direction:column;gap:8px;margin-top:12px}
.pill{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;background:#fff;border:1px solid var(--border);font-weight:700}
.detailGrid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
@media(max-width:520px){ .detailGrid{grid-template-columns:1fr} }
.cardItem{background:#fff;border-radius:10px;padding:10px;border:1px solid var(--border)}
.muted{color:var(--muted);font-size:13px}
.center{display:flex;align-items:center;justify-content:center}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <div class="header">
      <h1 class="title">Ultimate BMI Calculator</h1>
      <div class="brand">Fixvity</div>
    </div>

    <div class="grid">
      <!-- LEFT: simple inputs -->
      <section class="inputs" aria-label="Calculator inputs">
        <div style="display:flex;gap:8px;margin-bottom:12px">
          <button id="tabMetric" style="padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:#e8fbfd;font-weight:700">Metric</button>
          <button id="tabImperial" style="padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:#fff;font-weight:700">Imperial</button>
          <button id="tabOther" style="padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:#fff;font-weight:700">Other</button>
        </div>

        <div style="display:grid;gap:12px">
          <div>
            <label class="label">Age (years)</label>
            <input id="age" class="input" type="number" min="2" max="120" placeholder="25" />
          </div>

          <div>
            <label class="label">Sex</label>
            <select id="sex" class="input">
              <option value="">Prefer not to say</option>
              <option value="female">Female</option>
              <option value="male">Male</option>
            </select>
          </div>

          <div id="metricWeight">
            <label class="label">Weight (kg)</label>
            <input id="weightKg" class="input" type="number" step="0.1" placeholder="72.5" />
            <div class="muted">Kilograms (kg)</div>
          </div>

          <div id="metricHeight">
            <label class="label">Height (cm)</label>
            <input id="heightCm" class="input" type="number" step="0.1" placeholder="175" />
            <div class="muted">Centimetres (cm)</div>
          </div>

          <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
            <div style="display:flex;gap:8px">
              <button id="btnCalc" class="btnPrimary">Calculate</button>
              <button id="btnClear" class="btnGhost">Clear</button>
            </div>
            <div style="display:flex;gap:8px">
              <button id="btnSave" class="btnGhost">Save</button>
              <button id="btnPNG" class="btnGhost">Download PNG</button>
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT: results -->
      <aside class="results" id="resultCard" aria-live="polite">
        <div class="gaugeWrap">
          <div class="svgWrap" aria-hidden="false">
            <!-- VIEWBOX enlarged and overflow allowed via css container padding -->
            <svg class="gauge" id="gauge" viewBox="0 0 960 520" preserveAspectRatio="xMidYMid meet" role="img" aria-label="BMI gauge">
              <!-- soft outer background arc (butt caps to avoid round bubbles) -->
              <path id="bgArc" d="" stroke="rgba(2,6,23,0.06)" stroke-width="60" fill="none" stroke-linecap="butt"></path>

              <!-- colored segments (we draw via JS into these paths) -->
              <path id="seg0" stroke="#ef4444" stroke-width="48" fill="none" stroke-linecap="butt"></path>
              <path id="seg1" stroke="#10b981" stroke-width="48" fill="none" stroke-linecap="butt"></path>
              <path id="seg2" stroke="#f59e0b" stroke-width="48" fill="none" stroke-linecap="butt"></path>
              <path id="seg3" stroke="#ff8c42" stroke-width="48" fill="none" stroke-linecap="butt"></path>
              <path id="seg4" stroke="#e74c3c" stroke-width="48" fill="none" stroke-linecap="butt"></path>
              <path id="seg5" stroke="#812525" stroke-width="48" fill="none" stroke-linecap="butt"></path>

              <!-- subtle top highlight arc (shorter) -->
              <path id="topMark" d="" stroke="#ef4444" stroke-opacity="0.06" stroke-width="8" fill="none" stroke-linecap="round"></path>

              <!-- ticks & labels group -->
              <g id="tickGroup" font-family="Inter,Arial,Helvetica"></g>

              <!-- needle line and center knob -->
              <g id="needleGroup" transform="rotate(-90 480 360)">
                <line id="needleLine" x1="480" y1="360" x2="480" y2="240" stroke="#08151a" stroke-width="10" stroke-linecap="round" class="needle"></line>
                <circle id="knob" cx="480" cy="360" r="10" fill="#08151a"></circle>
              </g>
            </svg>
          </div>

          <!-- results row: BMI number + unit + category -->
          <div class="resultTop" style="margin-top:-4px">
            <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
              <div style="display:flex;align-items:center">
                <div id="bmiNumber" class="bmiNumber">—</div>
                <div class="unit">kg/m²</div>
              </div>
              <div style="display:flex;align-items:center">
                <div id="bmiCategory" class="category" style="color:var(--muted)">Enter values</div>
              </div>
            </div>
          </div>

          <!-- legend + detail boxes -->
          <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:14px">
            <div style="flex:1;min-width:220px">
              <div class="legend">
                <div class="pill"><span style="width:14px;height:14px;background:#ef4444;border-radius:6px;display:inline-block"></span>Underweight</div>
                <div class="pill"><span style="width:14px;height:14px;background:#10b981;border-radius:6px;display:inline-block"></span>Normal</div>
                <div class="pill"><span style="width:14px;height:14px;background:#f59e0b;border-radius:6px;display:inline-block"></span>Overweight</div>
                <div class="pill"><span style="width:14px;height:14px;background:#ff8c42;border-radius:6px;display:inline-block"></span>Obesity I</div>
                <div class="pill"><span style="width:14px;height:14px;background:#e74c3c;border-radius:6px;display:inline-block"></span>Obesity II</div>
                <div class="pill"><span style="width:14px;height:14px;background:#812525;border-radius:6px;display:inline-block"></span>Obesity III</div>
              </div>
            </div>

            <div style="flex:1;min-width:260px">
              <div class="detailGrid">
                <div class="cardItem"><div class="muted">Healthy BMI range</div><div style="font-weight:800;margin-top:6px">18.5 — 24.9</div></div>
                <div class="cardItem"><div class="muted">BMI Prime</div><div id="bmiPrime" style="font-weight:800;margin-top:6px">—</div></div>
                <div class="cardItem"><div class="muted">Ponderal Index</div><div id="ponderal" style="font-weight:800;margin-top:6px">—</div></div>
                <div class="cardItem"><div class="muted">Healthy weight</div><div id="healthyRange" style="font-weight:800;margin-top:6px">—</div></div>
              </div>
            </div>
          </div>

        </div>
      </aside>
    </div>
  </div>
</div>

<script>
/* Final JS: gauge draw + responsive placement + calculate + needle control
   Adjusted geometry to match your requested look:
   - viewBox 960x520, center at 480,360, radius 300
   - ticks and labels moved outward, labels given white stroke for visibility
   - background arc uses butt caps
   - topMark shorter, low opacity
   - needle shortened and rotated around center; BMI number smaller/less heavy
*/

const cx = 480, cy = 360, R = 300; // center + radius for the colored band
const segEls = [document.getElementById('seg0'),document.getElementById('seg1'),document.getElementById('seg2'),
                document.getElementById('seg3'),document.getElementById('seg4'),document.getElementById('seg5')];
const bgArc = document.getElementById('bgArc');
const topMark = document.getElementById('topMark');
const tickGroup = document.getElementById('tickGroup');
const needleGroup = document.getElementById('needleGroup');
const bmiNumber = document.getElementById('bmiNumber');
const bmiCategory = document.getElementById('bmiCategory');
const bmiPrimeEl = document.getElementById('bmiPrime');
const ponderalEl = document.getElementById('ponderal');
const healthyRangeEl = document.getElementById('healthyRange');

function polar(cx,cy,r,deg){
  const rad=(deg-90)*Math.PI/180;
  return {x:cx + r*Math.cos(rad), y:cy + r*Math.sin(rad)};
}
function arcPath(cx,cy,r,startDeg,endDeg){
  const start = polar(cx,cy,r,startDeg);
  const end   = polar(cx,cy,r,endDeg);
  const large = (endDeg - startDeg) > 180 ? 1 : 0;
  return `M ${start.x} ${start.y} A ${r} ${r} 0 ${large} 0 ${end.x} ${end.y}`;
}
// map BMI value (0..60) to gauge degrees (-90..+90)
function mapBMItoDeg(bmi){
  const v = Math.max(0, Math.min(bmi, 60));
  return (v/60)*180 - 90;
}

/* draw static arcs and ticks */
function drawGauge(){
  // background arc (full half)
  bgArc.setAttribute('d', arcPath(cx,cy,R+20,-90,90));

  // colored ranges
  const ranges = [
    {from:0,to:18.5}, {from:18.5,to:24.9}, {from:25,to:29.9},
    {from:30,to:34.9}, {from:35,to:39.9}, {from:40,to:60}
  ];
  ranges.forEach((rg,i)=>{
    const sdeg = mapBMItoDeg(rg.from);
    const edeg = mapBMItoDeg(Math.min(rg.to,60));
    // inset radius so color band sits inside background
    segEls[i].setAttribute('d', arcPath(cx,cy,R, sdeg, edeg));
  });

  // subtle shorter top mark
  topMark.setAttribute('d', arcPath(cx,cy,R+8, -66, 66)); // shorter arc

  // ticks and numeric labels
  tickGroup.innerHTML = '';
  const marks = [0,5,10,15,20,25,30,35,40,50,60];
  marks.forEach(v=>{
    const deg = mapBMItoDeg(v);
    const out = polar(cx,cy,R+36,deg);
    const inn = polar(cx,cy,R-28,deg);
    // tick line
    const ln = document.createElementNS('http://www.w3.org/2000/svg','line');
    ln.setAttribute('x1',out.x); ln.setAttribute('y1',out.y);
    ln.setAttribute('x2',inn.x); ln.setAttribute('y2',inn.y);
    ln.setAttribute('stroke','rgba(2,6,23,0.06)'); ln.setAttribute('stroke-width',3);
    tickGroup.appendChild(ln);

    // numeric label: pushed further out, with white stroke for readability
    const labelPos = polar(cx,cy,R+86,deg);
    const t = document.createElementNS('http://www.w3.org/2000/svg','text');
    t.setAttribute('x',labelPos.x);
    t.setAttribute('y',labelPos.y + 6);
    t.setAttribute('text-anchor','middle');
    t.setAttribute('font-size','18');
    t.setAttribute('font-weight','700');
    t.setAttribute('fill','#0b1720');
    t.setAttribute('stroke','#ffffff');
    t.setAttribute('stroke-width','6');
    t.setAttribute('paint-order','stroke');
    t.textContent = v;
    tickGroup.appendChild(t);
  });
}
drawGauge();

/* calculation helpers */
function cmToM(cm){ const c=Number(cm); return c>0 ? c/100 : null; }
function lbToKg(lb){ const l=Number(lb); return l>0 ? l*0.45359237 : null; }
function ftInToM(ft,inch){ const f=Number(ft)||0; const i=Number(inch)||0; const tot = f*12 + i; return tot>0 ? tot*0.0254 : null; }

function categoryFor(bmi){
  if(!Number.isFinite(bmi)) return {name:'—', color:'#666', note:'—'};
  if(bmi < 18.5) return {name:'Underweight', color:'#ef4444', note:'Below healthy range.'};
  if(bmi < 25) return {name:'Normal', color:'#10b981', note:'Within healthy range.'};
  if(bmi < 30) return {name:'Overweight', color:'#f59e0b', note:'Above healthy range.'};
  if(bmi < 35) return {name:'Obesity I', color:'#ff8c42', note:'Obesity I.'};
  if(bmi < 40) return {name:'Obesity II', color:'#e74c3c', note:'Obesity II.'};
  return {name:'Obesity III', color:'#812525', note:'Severe obesity.'};
}

function renderResult(bmi, kg, m){
  bmiNumber.textContent = bmi.toFixed(2);
  const cat = categoryFor(bmi);
  const catEl = document.getElementById('bmiCategory');
  catEl.textContent = cat.name;
  catEl.style.color = cat.color;

  const bmiPrime = bmi / 25;
  const ponderal = kg / (m*m*m);
  document.getElementById('bmiPrime').textContent = bmiPrime.toFixed(2);
  document.getElementById('ponderal').textContent = `${ponderal.toFixed(2)} kg/m³`;
  const low = 18.5 * m * m, high = 24.9 * m * m;
  document.getElementById('healthyRange').textContent = `${low.toFixed(1)} kg — ${high.toFixed(1)} kg`;

  // rotate needle: compute deg and set transform on needleGroup (rotate about cx,cy)
  const deg = mapBMItoDeg(bmi);
  needleGroup.setAttribute('transform', `rotate(${deg} ${cx} ${cy})`);

  // stylings to keep numbers readable on small screens are handled by CSS
}

/* simple UI wiring: use metric fields only for demo */
const btnCalc = document.getElementById('btnCalc');
const btnClear = document.getElementById('btnClear');
const weightKg = document.getElementById('weightKg');
const heightCm = document.getElementById('heightCm');

btnCalc.addEventListener('click', ()=>{
  const kg = Number(weightKg.value);
  const hcm = Number(heightCm.value);
  if(!(kg>0)){ alert('Enter weight (kg)'); return; }
  if(!(hcm>0)){ alert('Enter height (cm)'); return; }
  const m = cmToM(hcm);
  const bmi = kg / (m*m);
  renderResult(bmi, kg, m);
});

btnClear.addEventListener('click', ()=>{
  weightKg.value=''; heightCm.value='';
  document.getElementById('bmiNumber').textContent='—';
  document.getElementById('bmiCategory').textContent='Enter values';
  document.getElementById('bmiPrime').textContent='—';
  document.getElementById('ponderal').textContent='—';
  document.getElementById('healthyRange').textContent='—';
  // reset needle to center (pointing down)
  needleGroup.setAttribute('transform', `rotate(-90 ${cx} ${cy})`);
});

/* initial default: needle pointing down */
needleGroup.setAttribute('transform', `rotate(-90 ${cx} ${cy})`);

/* keep gauge responsive on resize */
let rt=null;
window.addEventListener('resize', ()=>{ if(rt) clearTimeout(rt); rt=setTimeout(()=>{ drawGauge(); },120); });
</script>
</body>
</html>
